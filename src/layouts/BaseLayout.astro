---
import Sidebar from "../components/Sidebar.astro";
import "../styles/global.css";
---

<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>LTC Kitchen Guide</title>
    <script>
      // Apply theme immediately to prevent flash (set only on <html> here)
      (function() {
        const savedTheme = localStorage.getItem('theme') || 'light';
        document.documentElement.setAttribute('data-theme', savedTheme);
      })();
    </script>
  </head>
  <body class="flex bg-gray-100">
    <!-- Sidebar -->
    <Sidebar />

    <!-- Main Content -->
    <main class="flex-1 p-6">
      <slot />
    </main>

    <!-- Theme Management Script -->
    <script>
      // Theme management functionality
      function switchTheme(theme) {
        document.documentElement.setAttribute('data-theme', theme);
        // Replace any existing theme class on body
        document.body.classList.remove('light', 'dark', 'spooky');
        document.body.classList.add(theme);
        localStorage.setItem('theme', theme);
        updateActiveThemeButton(theme);
      }

      function updateActiveThemeButton(activeTheme) {
        document.querySelectorAll('.theme-btn').forEach(btn => {
          btn.classList.remove('ring-2', 'ring-blue-500', 'bg-blue-200');
          if (btn.dataset.theme === activeTheme) {
            btn.classList.add('ring-2', 'ring-blue-500', 'bg-blue-200');
          }
        });
      }

      // Initialize body class after DOM is ready and wire listeners
      document.addEventListener('DOMContentLoaded', function() {
        const savedTheme = localStorage.getItem('theme') || 'light';
        document.body.classList.remove('light', 'dark', 'spooky');
        document.body.classList.add(savedTheme);
        updateActiveThemeButton(savedTheme);
        
        document.querySelectorAll('.theme-btn').forEach(btn => {
          btn.addEventListener('click', (e) => {
            e.preventDefault();
            switchTheme(btn.dataset.theme);
          });
        });
      });
    </script>
  </body>
</html>
